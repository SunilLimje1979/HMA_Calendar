{% extends "adminpanel/adminBase.html" %}
{% block content %}
<div class="card">
    <div class="card-body m-0 p-3">
        <!-- Header row -->
        <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap">
            <!-- Breadcrumb -->
            <div class="mb-2 mb-sm-0">
                <a href="{% url 'adminIndex' %}" class="text-decoration-none text-dark font-weight-bold" title="Go to Dashboard">
                    Dashboard
                </a>
                <span class="mx-1">/</span>
                <span class="text-primary">Registered Members</span>
            </div>
        </div>
        <div class="mt-2">
            <div class="row">
                <div class="col-sm-12">
                    
                    <div class="d-flex justify-content-end mb-2">
                        <button id="printPdfBtn" class="btn btn-sm btn-primary" {% if not members %}style="display: none;"{%endif%}>
                            <i class="fa fa-print"></i> Print List PDF
                        </button>
                    </div>

                    <div class="table-responsive">
                        <table id="table_id" class="table table-hover table-center mb-0 mt-2">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Mobile No.</th>
                                    <th>Registered On</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% if members %}
                                    {% for member in members %}
                                        <tr>
                                            <td>{{ member.user.first_name }}</td>
                                            <td>{{ member.phone_number }}</td>    
                                            <td>{{ member.user.date_joined|date:"d-m-Y" }}</td>
                                        </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr>
                                        <td colspan="7" class="text-center">No Users registered .</td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div id="loaderOverlay" class="loader-overlay" style="display: none;">
            <div class="loader"></div>
        </div>

    </div>
</div>

 

<div id="printArea" style="display:none;">
    <h3 style="text-align:center; margin-bottom:20px;">Registered Members Report</h3>
    <table border="1" cellspacing="0" cellpadding="8" width="100%" style="border-collapse: collapse; font-size: 14px;">
        <thead>
            <tr style="background:#f2f2f2;">
                <th>Name</th>
                <th>Mobile No.</th>
                <th>Registered On</th>
            </tr>
        </thead>
        <tbody>
            {% for member in members %}
            <tr>
                <td>{{ member.user.first_name }}</td>
                <td>{{ member.phone_number }}</td>
                <td>{{ member.user.date_joined|date:"d-m-Y" }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>




<script>
  $(document).ready(function () {
    $('#table_id').DataTable({
      "order": [], // ‚ùå Disable default sorting
      "paging": true, // keep pagination if needed
      "info": true,
      "searching": true
    });
  });
</script>
<script>
document.getElementById("printPdfBtn").addEventListener("click", function () {
    var printContents = document.getElementById("printArea").innerHTML;

    var win = window.open("", "_blank");  // Open in new tab
    win.document.write(`
        <html>
            <head>
                <title>Registered Members PDF</title>
                <style>
                    body { font-family: Arial, sans-serif; margin: 20px; }
                    table { width: 100%; border-collapse: collapse; }
                    th, td { border: 1px solid #333; padding: 6px; text-align: left; }
                    th { background: #f2f2f2; }
                    h3 { text-align: center; margin-bottom: 20px; }
                </style>
            </head>
            <body>
                ${printContents}
            </body>
        </html>
    `);

    win.document.close();
    win.focus();

    setTimeout(function () {
        win.print();   // trigger PDF print/save
    }, 400);
});
</script>




{% endblock content %}